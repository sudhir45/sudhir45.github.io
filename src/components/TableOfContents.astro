---
---
<nav class="toc">
  <ul class="flex flex-col gap-1.5 text-sm">
    {
      Astro.props.headings.map((heading: any) => {
        const padding = heading.depth === 2 ? 'pl-0' : heading.depth === 3 ? 'pl-4' : 'pl-8';
        return (
          <li class={padding}>
            <a 
              href={`#${heading.slug}`}
              class="block rounded-md px-2 py-1.5 text-zinc-600 transition-colors hover:bg-zinc-100 hover:text-blue-600 dark:text-zinc-400 dark:hover:bg-zinc-900 dark:hover:text-blue-400"
            >
              {heading.text}
            </a>
          </li>
        );
      })
    }
  </ul>
</nav>

<script>
  // Intersection observer for active TOC highlighting
  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      const id = entry.target.getAttribute('id');
      const link = document.querySelector(`.toc a[href="#${id}"]`);
      if (link) {
        if (entry.intersectionRatio > 0.1) {
          link.classList.add('bg-blue-50', 'text-blue-600', 'font-medium', 'dark:bg-blue-950/30', 'dark:text-blue-400');
          link.classList.remove('text-zinc-600', 'dark:text-zinc-400');
        } else {
          link.classList.remove('bg-blue-50', 'text-blue-600', 'font-medium', 'dark:bg-blue-950/30', 'dark:text-blue-400');
          link.classList.add('text-zinc-600', 'dark:text-zinc-400');
        }
      }
    });
  }, {
    rootMargin: '-20% 0% -70% 0%'
  });

  document.querySelectorAll('h2[id], h3[id], h4[id]').forEach((section) => {
    observer.observe(section);
  });
</script>
